use std::libc::{ puts };
use std::panic::{ assert };

struct test_struct {
    a: i8*
}

func test_change_struct(a: test_struct&) {
    a.a = "hello";
}

func test(a: i64&) {
    a += 1;
}

func test_addr(a: i64*) {
    a[0] += 1;
}

func main() -> i32 {
    var c = 1;
    test_addr(c.__ptr__());
    assert(c == 2, "c != 2");
    test_addr(c.__ptr__()->__ptr__());
    assert(c == 3, "c != 3");

    var a = 1;
    test(a);
    assert(a == 2, "a != 2");

    var b = test_struct { a: nil };
    test_change_struct(b);
    puts(b.a);
    return 0;
}